webpackJsonp([24],{"06NH":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("Dd8w"),c=s.n(i),a=s("gyMJ"),o=s("NYxO"),n=s("j3Q2"),r=s("GQaK"),l={name:"ShopCart",data:function(){return{isSelectAll:!1,totalPrice:0,currentDelGoods:{}}},computed:c()({},Object(o.d)(["userInfo","cartgoods"])),activated:function(){this.$store.dispatch("reqCartsGoods"),this._initWrapper()},mounted:function(){this.$store.dispatch("reqCartsGoods")},components:{SelectLogin:n.a},methods:{_initWrapper:function(){this.$refs.wrapper&&(this.$refs.wrapper.style.height=document.getElementById("app").offsetHeight-document.getElementById("bottomTabBar").offsetHeight-document.getElementById("shopCartHeader").offsetHeight-document.getElementById("tab_bar").offsetHeight+"px",this.$refs.content.style.minHeight=this.$refs.wrapper.offsetHeight+1+"px")},updateGoodsCount:function(t,e){Object(a.n)(t.buy_count,t.goods_id,this.userInfo.id,e),this.$store.dispatch("reqCartsGoods",this.checked(t)),this.getAllGoodsPrice()},checked:function(t){t.checked&&this.singerGoodsSelected(t)},selectAll:function(t){this.isSelectAll=!this.isSelectAll,this.$store.dispatch("selectedAll",{isSelectAll:t}),this.getAllGoodsPrice()},getAllGoodsPrice:function(){var t=0;this.cartgoods.forEach(function(e,s){e.checked&&(t+=e.price/100*e.buy_count)}),this.totalPrice=t},singerGoodsSelected:function(t){this.$store.dispatch("singerGoodsSelected",{goods:t}),this.getAllGoodsPrice(),this.isSelectedAll()},isSelectedAll:function(){var t=!0;this.cartgoods.forEach(function(e,s){e.checked||(t=!1)}),this.isSelectAll=t},clickTrash:function(t){var e=this;this.$messagebox.confirm("您确定删除该商品吗?").then(function(s){"confirm"===s&&(Object(a.n)(0,t.goods_id,e.userInfo.id,!1),e.$store.dispatch("reqCartsGoods"),e.getAllGoodsPrice())})},_initBScroll:function(){this.listScroll=new r.a(".jd_shopCart_list",{click:!0,scrollY:!0,bounceTime:300}),this.listScroll.on("touchEnd",function(t){})}},watch:{cartgoods:function(){var t=this;this.$nextTick(function(){t.listScroll?t.listScroll.refresh():t._initBScroll(),t.isSelectAll&&t.$store.dispatch("selectedAll",{isSelectAll:!1}),t.getAllGoodsPrice()})}},filters:{moneyFormat:function(t){return"¥"+t.toFixed(2)}}},d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop-cart"},[t.userInfo.id?s("div",{staticClass:"cart"},[t._m(0),t._v(" "),s("main",{ref:"wrapper",staticClass:"jd_shopCart_list"},[s("section",{ref:"content"},t._l(t.cartgoods,function(e,i){return s("div",{key:i,staticClass:"shopCart_list_con"},[s("div",{staticClass:"list_con_left"},[s("a",{staticClass:"cart_check_box",attrs:{href:"javascript:;",checked:e.checked},on:{click:function(s){s.preventDefault(),t.singerGoodsSelected(e)}}})]),t._v(" "),s("div",{staticClass:"list_con_right"},[s("div",{staticClass:"shop_img"},[s("img",{attrs:{src:e.thumb_url}})]),t._v(" "),s("div",{staticClass:"shop_con"},[s("a",{attrs:{href:"javascript:;"}},[t._v(t._s(e.goods_name))]),t._v(" "),s("p",{staticClass:"shop_price"},[t._v(t._s(t._f("moneyFormat")(e.price/100,e.price)))]),t._v(" "),s("div",{staticClass:"shop_deal"},[s("div",{staticClass:"shop_deal_left"},[s("button",{staticClass:"change",on:{click:function(s){s.preventDefault(),t.updateGoodsCount(e,!1)}}},[t._v("-")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.buy_count,expression:"goods.buy_count"}],attrs:{type:"tel",value:"1",disabled:"disabled"},domProps:{value:e.buy_count},on:{input:function(s){s.target.composing||t.$set(e,"buy_count",s.target.value)}}}),t._v(" "),s("button",{staticClass:"change",on:{click:function(s){s.preventDefault(),t.updateGoodsCount(e,!0)}}},[t._v("+")])]),t._v(" "),s("div",{staticClass:"shop_deal_right",on:{click:function(s){s.preventDefault(),s.stopPropagation(),t.clickTrash(e)}}},[s("span"),t._v(" "),s("span")])])])])])}))]),t._v(" "),s("div",{attrs:{id:"tab_bar"}},[s("div",{staticClass:"tab-bar-left"},[s("a",{staticClass:"cart_check_box",attrs:{href:"javascript:;",checked:t.isSelectAll},on:{click:function(e){e.preventDefault(),e.stopPropagation(),t.selectAll(t.isSelectAll)}}}),t._v(" "),s("span",{staticStyle:{"font-size":"16px"}},[t._v("全选")]),t._v(" "),s("div",{staticClass:"select-all"},[t._v("\n          合计："),s("span",{staticClass:"total-price"},[t._v(t._s(t._f("moneyFormat")(t.totalPrice,t.totalPrice)))])])]),t._v(" "),t._m(1)])]):s("select-login")],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"shopCartHeader"}},[e("div",{staticClass:"header"},[e("a",{staticClass:"icon_back",attrs:{href:"javascript:;"}}),this._v(" "),e("h3",[this._v("购物车")]),this._v(" "),e("a",{staticClass:"icon_menu",attrs:{href:"javascript:;"}})]),this._v(" "),e("div",{staticClass:"jd_safe_tip"},[e("p",{staticClass:"tip_word"},[this._v("\n          您正在安全购物环境中，请放心购物\n        ")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tab-bar-right"},[e("a",{staticClass:"pay",attrs:{href:"javascript:;"}},[this._v("去结算")])])}]};var h=s("VU/8")(l,d,!1,function(t){s("I2Gn")},"data-v-26687f90",null);e.default=h.exports},I2Gn:function(t,e){}});